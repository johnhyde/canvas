import{S as t,i as e,s as o,a4 as n,c as a,a as s,d as l,b as r,a5 as i,f as c,a6 as f,T as h,a7 as d,a8 as u,a9 as g,aa as $,l as m,V as p,ab as v,ac as w,ad as x,v as y,j as b,m as k,o as E,J as M,r as j,w as C,B as S,u as B,ae as I,k as N,n as P,U as T,K as A,G,I as H,af as O,ag as R}from"./vendor-06f69df3.js";import{s as J}from"./store-723eec23.js";function K(t,e,o){const{x:n,y:a}=function(t,e){return{x:Math.floor(t/e),y:t%e}}(t,e);return Math.floor(function(t,e,o){return o*t+e}(n,a+0,o))}function U(t){let e,o,u,g,$;return{c(){e=n("path"),this.h()},l(t){e=a(t,"path",{d:!0,fill:!0,class:!0},1),s(e).forEach(l),this.h()},h(){r(e,"d",o=t[2](i(t[0],t[1]))),r(e,"fill",u=t[1].attr&&t[1].attr.fill?t[1].attr.color:void 0),r(e,"class","svelte-td270i")},m(o,n){c(o,e,n),g||($=[f(e,"mousedown",t[3]),f(e,"mouseup",t[5]),f(e,"mousemove",t[4])],g=!0)},p(t,[n]){3&n&&o!==(o=t[2](i(t[0],t[1])))&&r(e,"d",o),2&n&&u!==(u=t[1].attr&&t[1].attr.fill?t[1].attr.color:void 0)&&r(e,"fill",u)},i:h,o:h,d(t){t&&l(e),g=!1,d($)}}}function V(t,e,o){let n,{topology:a}=e,{d:s}=e,{selectedColor:l}=e,{mousing:r}=e;const i=u(),c=function(t){const e=2*t*Math.sin(Math.PI/3),o=1.5*t;return{stream:function(t){return{point:function(n,a){t.point(n*e/2,(a-(2-(1&a))/3)*o/2)},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}}}(10),f=g().projection(c);function h(){if(r){const t=r>0;i("update",{id:s.id,data:{fill:t,color:t?n:void 0}}),0!==r&&i("save",{id:s.id,fill:t,color:r>0?n:""})}}return t.$$set=t=>{"topology"in t&&o(0,a=t.topology),"d"in t&&o(1,s=t.d),"selectedColor"in t&&o(7,l=t.selectedColor),"mousing"in t&&o(6,r=t.mousing)},t.$$.update=()=>{128&t.$$.dirty&&(n=$(l).formatHex())},[a,s,f,function(t){3!==t.which&&(o(6,r=s.attr.fill&&s.attr.color===n?-1:1),h())},h,function(){h(),o(6,r=0),i("flush")},r,l]}class Y extends t{constructor(t){super(),e(this,t,V,U,o,{topology:0,d:1,selectedColor:7,mousing:6})}}function q(t,e,o){const n=t.slice();return n[7]=e[o],n}function z(t){let e,o,i,h,d,u;function g(){return t[5](t[7])}return{c(){e=n("rect"),this.h()},l(t){e=a(t,"rect",{x:!0,width:!0,height:!0,stroke:!0,fill:!0},1),s(e).forEach(l),this.h()},h(){r(e,"x",o=t[7]<9?24*t[7]:24*(t[7]+1)),r(e,"width","21"),r(e,"height","21"),r(e,"stroke",i=t[7]===t[1]?"#000":"gray"),r(e,"fill",h=t[7]<9?t[2](t[7]):t[3](t[7]))},m(t,o){c(t,e,o),d||(u=f(e,"click",g),d=!0)},p(n,a){t=n,1&a&&o!==(o=t[7]<9?24*t[7]:24*(t[7]+1))&&r(e,"x",o),3&a&&i!==(i=t[7]===t[1]?"#000":"gray")&&r(e,"stroke",i),1&a&&h!==(h=t[7]<9?t[2](t[7]):t[3](t[7]))&&r(e,"fill",h)},d(t){t&&l(e),d=!1,u()}}}function D(t){let e,o=t[0],n=[];for(let a=0;a<o.length;a+=1)n[a]=z(q(t,o,a));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=m()},l(t){for(let e=0;e<n.length;e+=1)n[e].l(t);e=m()},m(t,o){for(let e=0;e<n.length;e+=1)n[e].m(t,o);c(t,e,o)},p(t,[a]){if(31&a){let s;for(o=t[0],s=0;s<o.length;s+=1){const l=q(t,o,s);n[s]?n[s].p(l,a):(n[s]=z(l),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=o.length}},i:h,o:h,d(t){p(n,t),t&&l(e)}}}function F(t,e,o){let{colors:n}=e,a=0;const s=u(),l=v().domain(w(9)).range(["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"]),r=v().domain(w(9)).range(x[9]);function i(t){o(1,a=t),s("color",{color:t<9?l(t):r(t)})}return t.$$set=t=>{"colors"in t&&o(0,n=t.colors)},[n,a,l,r,i,t=>i(t)]}class L extends t{constructor(t){super(),e(this,t,F,D,o,{colors:0})}}function Q(t,e,o){const n=t.slice();return n[23]=e[o],n[24]=e,n[25]=o,n}function W(t){let e,o,n=t[3],a=[];for(let l=0;l<n.length;l+=1)a[l]=X(Q(t,n,l));const s=t=>j(a[t],1,1,(()=>{a[t]=null}));return{c(){for(let t=0;t<a.length;t+=1)a[t].c();e=m()},l(t){for(let e=0;e<a.length;e+=1)a[e].l(t);e=m()},m(t,n){for(let e=0;e<a.length;e+=1)a[e].m(t,n);c(t,e,n),o=!0},p(t,o){if(3740&o){let l;for(n=t[3],l=0;l<n.length;l+=1){const s=Q(t,n,l);a[l]?(a[l].p(s,o),y(a[l],1)):(a[l]=X(s),a[l].c(),y(a[l],1),a[l].m(e.parentNode,e))}for(S(),l=n.length;l<a.length;l+=1)s(l);B()}},i(t){if(!o){for(let t=0;t<n.length;t+=1)y(a[t]);o=!0}},o(t){a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)j(a[e]);o=!1},d(t){p(a,t),t&&l(e)}}}function X(t){let e,o,n,a,s,l;function r(e){t[14](e)}function i(e){t[15](e,t[23],t[24],t[25])}function c(e){t[16](e)}function f(e){t[17](e)}let h={};return void 0!==t[2]&&(h.topology=t[2]),void 0!==t[23]&&(h.d=t[23]),void 0!==t[7]&&(h.selectedColor=t[7]),void 0!==t[4]&&(h.mousing=t[4]),e=new Y({props:h}),G.push((()=>H(e,"topology",r))),G.push((()=>H(e,"d",i))),G.push((()=>H(e,"selectedColor",c))),G.push((()=>H(e,"mousing",f))),e.$on("update",t[9]),e.$on("save",t[10]),e.$on("flush",t[11]),{c(){b(e.$$.fragment)},l(t){k(e.$$.fragment,t)},m(t,o){E(e,t,o),l=!0},p(l,r){t=l;const i={};!o&&4&r&&(o=!0,i.topology=t[2],M((()=>o=!1))),!n&&8&r&&(n=!0,i.d=t[23],M((()=>n=!1))),!a&&128&r&&(a=!0,i.selectedColor=t[7],M((()=>a=!1))),!s&&16&r&&(s=!0,i.mousing=t[4],M((()=>s=!1))),e.$set(i)},i(t){l||(y(e.$$.fragment,t),l=!0)},o(t){j(e.$$.fragment,t),l=!1},d(t){C(e,t)}}}function Z(t){let e,o,i,f,h;function d(e){t[18](e)}let u={};return void 0!==t[5]&&(u.colors=t[5]),o=new L({props:u}),G.push((()=>H(o,"colors",d))),o.$on("color",t[12]),{c(){e=n("g"),b(o.$$.fragment),this.h()},l(t){e=a(t,"g",{class:!0,transform:!0},1);var n=s(e);k(o.$$.fragment,n),n.forEach(l),this.h()},h(){r(e,"class","palette svelte-1bkwhko"),r(e,"transform",f=`translate(${t[0]/2-216-3}, ${2.5*ot})`)},m(t,n){c(t,e,n),E(o,e,null),h=!0},p(t,n){const a={};!i&&32&n&&(i=!0,a.colors=t[5],M((()=>i=!1))),o.$set(a),(!h||1&n&&f!==(f=`translate(${t[0]/2-216-3}, ${2.5*ot})`))&&r(e,"transform",f)},i(t){h||(y(o.$$.fragment,t),h=!0)},o(t){j(o.$$.fragment,t),h=!1},d(t){t&&l(e),C(o)}}}function _(t){let e,o,n,a;return e=new O({props:{indented:!0,labelText:"Export canvas..."}}),e.$on("click",t[20]),n=new R({}),{c(){b(e.$$.fragment),o=N(),b(n.$$.fragment)},l(t){k(e.$$.fragment,t),o=P(t),k(n.$$.fragment,t)},m(t,s){E(e,t,s),c(t,o,s),E(n,t,s),a=!0},p:h,i(t){a||(y(e.$$.fragment,t),y(n.$$.fragment,t),a=!0)},o(t){j(e.$$.fragment,t),j(n.$$.fragment,t),a=!1},d(t){C(e,t),t&&l(o),C(n,t)}}}function tt(t){let e,o,n,a=(t[8].gcp||t[8].s3.credentials)&&_(t);return o=new O({props:{labelText:"Show color palette",selected:t[6]}}),o.$on("click",t[21]),{c(){a&&a.c(),e=N(),b(o.$$.fragment)},l(t){a&&a.l(t),e=P(t),k(o.$$.fragment,t)},m(t,s){a&&a.m(t,s),c(t,e,s),E(o,t,s),n=!0},p(t,n){t[8].gcp||t[8].s3.credentials?a?(a.p(t,n),256&n&&y(a,1)):(a=_(t),a.c(),y(a,1),a.m(e.parentNode,e)):a&&(S(),j(a,1,1,(()=>{a=null})),B());const s={};64&n&&(s.selected=t[6]),o.$set(s)},i(t){n||(y(a),y(o.$$.fragment,t),n=!0)},o(t){j(a),j(o.$$.fragment,t),n=!1},d(t){a&&a.d(t),t&&l(e),C(o,t)}}}function et(t){let e,o,i,h,d,u,g,$,m,p,v=t[3]&&t[2]&&W(t),w=t[6]&&Z(t);return g=new I({props:{$$slots:{default:[tt]},$$scope:{ctx:t}}}),{c(){e=n("svg"),o=n("g"),v&&v.c(),w&&w.c(),i=n("rect"),u=N(),b(g.$$.fragment),this.h()},l(t){e=a(t,"svg",{width:!0,height:!0,id:!0,viewBox:!0,preserveAspectRatio:!0,class:!0},1);var n=s(e);o=a(n,"g",{class:!0,transform:!0},1);var r=s(o);v&&v.l(r),r.forEach(l),w&&w.l(n),i=a(n,"rect",{width:!0,height:!0,class:!0},1),s(i).forEach(l),n.forEach(l),u=P(t),k(g.$$.fragment,t),this.h()},h(){r(o,"class","hexagon svelte-1bkwhko"),r(o,"transform",`translate(${ot}, ${ot})`),r(i,"width",t[0]),r(i,"height",h=t[1]+2.5*ot),r(i,"class","border svelte-1bkwhko"),r(e,"width",t[0]),r(e,"height",t[1]),r(e,"id","canvas"),r(e,"viewBox",d=`0 0 ${t[0]} ${t[1]+2.5*ot}`),r(e,"preserveAspectRatio","xMaxYMin meet"),r(e,"class","svelte-1bkwhko")},m(n,a){c(n,e,a),T(e,o),v&&v.m(o,null),w&&w.m(e,null),T(e,i),c(n,u,a),E(g,n,a),$=!0,m||(p=f(e,"mouseleave",t[19]),m=!0)},p(t,[n]){t[3]&&t[2]?v?(v.p(t,n),12&n&&y(v,1)):(v=W(t),v.c(),y(v,1),v.m(o,null)):v&&(S(),j(v,1,1,(()=>{v=null})),B()),t[6]?w?(w.p(t,n),64&n&&y(w,1)):(w=Z(t),w.c(),y(w,1),w.m(e,i)):w&&(S(),j(w,1,1,(()=>{w=null})),B()),(!$||1&n)&&r(i,"width",t[0]),(!$||2&n&&h!==(h=t[1]+2.5*ot))&&r(i,"height",h),(!$||1&n)&&r(e,"width",t[0]),(!$||2&n)&&r(e,"height",t[1]),(!$||3&n&&d!==(d=`0 0 ${t[0]} ${t[1]+2.5*ot}`))&&r(e,"viewBox",d);const a={};67109184&n&&(a.$$scope={dirty:n,ctx:t}),g.$set(a)},i(t){$||(y(v),y(w),y(g.$$.fragment,t),$=!0)},o(t){j(v),j(w),j(g.$$.fragment,t),$=!1},d(t){t&&l(e),v&&v.d(),w&&w.d(),t&&l(u),C(g,t),m=!1,p()}}}const ot=10;function nt(t,e,o){let n;A(t,J,(t=>o(8,n=t)));let a,s,{width:l}=e,{height:r}=e,{canvas:i}=e,c={},f=0,h=w(18),d=!0,u="#d53e4f";return t.$$set=t=>{"width"in t&&o(0,l=t.width),"height"in t&&o(1,r=t.height),"canvas"in t&&o(13,i=t.canvas)},t.$$.update=()=>{8199&t.$$.dirty&&i.data&&(o(2,s=function(t,e,o,n,a,s){const l=2*e*Math.sin(Math.PI/3),r=1.5*e,i=Math.ceil((n+e)/r)+1,c=Math.ceil(o/l)+1,f=s?Math.ceil(s/l)+1:o,h=[],d=[];let u=0;for(let m=-1;m<=i;++m)for(let t=-1;t<=c;++t){const e=2*m,o=2*(t+(1&m)/2);d.push([[o,e-1],[1,1]],[[o+1,e],[0,1]],[[o+1,e+1],[-1,1]])}const g=Object.keys(a),$={};g.map((t=>{s&&o!==s?$[K(t,f,c)]=t:$[t]=t}));for(let m=0,p=3;m<i;++m,p+=6)for(let e=0;e<c;++e,p+=3)h.push({id:u.toString(),name:t,type:"Polygon",arcs:[[p,p+1,p+2,~(p+3*(c+2-(1&m))),~(p-2),~(p-3*(c+2+(1&m))+2)]],attr:a&&a[$[u]]||{}}),++u;return{transform:{translate:[0,0],scale:[1,1]},objects:{hexagons:{type:"GeometryCollection",geometries:h}},arcs:d}}(i.metadata.name,ot,l,r,i.data,i.metadata.width)),o(3,a=s.objects.hexagons.geometries))},[l,r,s,a,f,h,d,u,n,function(t){o(13,i.data[t.detail.id]=t.detail.data,i)},function(t){const{id:e,fill:o,color:n}=t.detail;c[e]={mesh:{id:e,fill:o,color:n}}},function(){const t=Object.values(c),{location:e,name:o}=i.metadata;t.length>0&&"mesh-welcome"!==i.metadata.template&&n.api.send(e,o,t),c={}},function(t){o(7,u=t.detail.color)},i,function(t){s=t,o(2,s),o(13,i),o(0,l),o(1,r)},function(t,e,n,c){n[c]=t,o(3,a),o(13,i),o(0,l),o(1,r),o(2,s)},function(t){u=t,o(7,u)},function(t){f=t,o(4,f)},function(t){h=t,o(5,h)},()=>{o(4,f=0)},()=>console.log("exporting"),()=>o(6,d=!d)]}class at extends t{constructor(t){super(),e(this,t,nt,et,o,{width:0,height:1,canvas:13})}}export{at as H};
