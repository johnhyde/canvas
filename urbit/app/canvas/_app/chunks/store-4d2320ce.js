var n=Object.defineProperty,e=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,c=(e,a,o)=>a in e?n(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,i=(n,e)=>{for(var a in e||(e={}))t.call(e,a)&&c(n,a,e[a]);if(o)for(var a of o(e))s.call(e,a)&&c(n,a,e[a]);return n},r=(n,o)=>e(n,a(o));import{Q as p,C as l}from"./vendor-9bedaea6.js";const u={chats:[],connection:"disconnected",ship:window.ship,name:`~${window.ship}/welcome`,radius:10,gcp:null,s3:{configuration:{buckets:new Set,currentBucket:""},credentials:null}},{subscribe:d,update:f}=l(u);function v(n){console.log("[createCanvasStore]",n);const[e,a]=function(n){const e=[],a=[];return Object.entries(n).map((([n,o])=>{o.metadata.private?e.push(n):a.push(n)})),[e,a]}(n);f((o=>r(i({},o),{canvas:n,privateCanvas:e,publicCanvas:a})))}function b(n){(function(n){return"string"==typeof n.accessKey&&"number"==typeof n.expiresIn})(n)&&(console.log("[loadGCPToken]"),f((e=>r(i({},e),{gcp:{gcpToken:n}}))))}function g(n){console.log("[loadS3Creds]"),f((e=>r(i({},e),{s3:r(i({},e.s3),{credentials:n,client:new p({credentials:n,endpoint:n.endpoint,region:"us-east-1"})})})))}function m(n){console.log("[loadS3Config]"),f((e=>r(i({},e),{s3:r(i({},e.s3),{configuration:n})})))}function C(n){const e=`${n.location}/${n.name}`;console.log("[loadCanvas]",n,n.name),f((a=>r(i({},a),{canvas:i({[e]:{metadata:i({},n),data:n.data}},a.canvas),publicCanvas:n.private?a.publicCanvas:[e,...a.publicCanvas],privateCanvas:n.private?[e,...a.privateCanvas]:a.privateCanvas,name:e})))}function w(n){console.log("[painting]",n),f((e=>{const a=`${n.location}/${n.name}`;return n.strokes.forEach((n=>{e.canvas[a].data[n.id]=i({},n)})),e}))}function y(n){f((e=>r(i({},e),{connection:n})))}function O(n){f((e=>r(i({},e),{api:n})))}function h(n){f((e=>r(i({},e),{subscription:n})))}function j(n){f((e=>r(i({},e),{name:n})))}var P={subscribe:d};export{g as a,m as b,v as c,P as d,O as e,h as f,j as g,C as l,w as p,b as s,y as u};
