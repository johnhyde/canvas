var n=Object.defineProperty,a=Object.defineProperties,e=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,c=(a,e,o)=>e in a?n(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o,i=(n,a)=>{for(var e in a||(a={}))t.call(a,e)&&c(n,e,a[e]);if(o)for(var e of o(a))s.call(a,e)&&c(n,e,a[e]);return n},r=(n,o)=>a(n,e(o));import{P as p,C as l}from"./vendor-04a7db10.js";const u={chats:[],connection:"disconnected",ship:window.ship,name:`~${window.ship}/welcome`,radius:10,gcp:null,s3:{configuration:{buckets:new Set,currentBucket:""},credentials:null}},{subscribe:d,update:f}=l(u);function v(n){console.log("[createCanvasStore]",n);const[a,e]=function(n){const a=[],e=[];return Object.entries(n).map((([n,o])=>{o.metadata.private?a.push(n):e.push(n)})),[a,e]}(n);f((o=>r(i({},o),{canvas:n,privateCanvas:a,publicCanvas:e})))}function b(n){(function(n){return"string"==typeof n.accessKey&&"number"==typeof n.expiresIn})(n)&&(console.log("[loadGCPToken]"),f((a=>r(i({},a),{gcp:{gcpToken:n}}))))}function g(n){console.log("[loadS3Creds]"),f((a=>r(i({},a),{s3:r(i({},a.s3),{credentials:n,client:new p({credentials:n,endpoint:n.endpoint,region:"us-east-1"})})})))}function m(n){console.log("[loadS3Config]"),f((a=>r(i({},a),{s3:r(i({},a.s3),{configuration:n})})))}function C(n){const a=`${n.location}/${n.name}`;console.log("[loadCanvas]",n,n.name),f((e=>r(i({},e),{canvas:i({[a]:{metadata:i({},n),data:n.data}},e.canvas),publicCanvas:n.private?e.publicCanvas:[a,...e.publicCanvas],privateCanvas:n.private?[a,...e.privateCanvas]:e.privateCanvas,name:a})))}function w(n){console.log("[painting]",n),f((a=>{const e=`${n.location}/${n.name}`;return n.strokes.forEach((n=>{a.canvas[e].data[n.id]=i({},n)})),a}))}function y(n){f((a=>r(i({},a),{connection:n})))}function O(n){f((a=>r(i({},a),{api:n})))}function h(n){f((a=>r(i({},a),{subscription:n})))}function j(n){f((a=>r(i({},a),{name:n})))}var P={subscribe:d};export{g as a,m as b,v as c,P as d,O as e,h as f,j as g,C as l,w as p,b as s,y as u};
