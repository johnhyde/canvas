var n=Object.defineProperty,e=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,c=(e,a,o)=>a in e?n(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,r=(n,e)=>{for(var a in e||(e={}))s.call(e,a)&&c(n,a,e[a]);if(o)for(var a of o(e))t.call(e,a)&&c(n,a,e[a]);return n},i=(n,o)=>e(n,a(o));import{P as l,C as p}from"./vendor-04a7db10.js";const u={chats:[],connection:"disconnected",ship:window.ship,name:`~${window.ship}/welcome`,radius:10,gcp:null,s3:{configuration:{buckets:new Set,currentBucket:""},credentials:null}},{subscribe:v,update:d}=p(u);function f(n){console.log("[createCanvasStore]",n);const[e,a]=function(n){const e=[],a=[];return Object.entries(n).map((([n,o])=>{o.metadata.private?e.push(n):a.push(n)})),[e,a]}(n);console.log(e,a),d((o=>(console.log("createCanvasStore",o.name),i(r({},o),{canvas:n,privateCanvas:e,publicCanvas:a}))))}function g(n){(function(n){return"string"==typeof n.accessKey&&"number"==typeof n.expiresIn})(n)&&(console.log("[loadGCPToken]",n),d((e=>(console.log("saveGCPToken",e.name),i(r({},e),{gcp:{gcpToken:n}})))))}function b(n){console.log("[loadS3Creds]",n),d((e=>(console.log("saveS3credentials",e.name),i(r({},e),{s3:i(r({},e.s3),{credentials:n,client:new l({credentials:n,endpoint:n.endpoint,region:"us-east-1"})})}))))}function m(n){console.log("[loadS3Config]",n),d((e=>(console.log("saveS3config",e.name),i(r({},e),{s3:i(r({},e.s3),{configuration:n})}))))}function C(n){const e=`${n.location}/${n.name}`;console.log("[loadCanvas]",n,n.name,e),d((a=>i(r({},a),{canvas:r({[e]:{metadata:r({},n),data:n.data}},a.canvas),publicCanvas:n.private?a.publicCanvas:[e,...a.publicCanvas],privateCanvas:n.private?[e,...a.privateCanvas]:a.privateCanvas,name:e})))}function w(n){console.log("[painting]",n),d((e=>{const a=`${n.location}/${n.name}`;return n.strokes.forEach((n=>{console.log(n),e.canvas[a].data[n.id]=r({},n)})),e}))}function y(n){d((e=>i(r({},e),{connection:n})))}function O(n){d((e=>i(r({},e),{api:n})))}function h(n){d((e=>i(r({},e),{subscription:n})))}function j(n){console.log("updateCurrentCanvas",n),d((e=>i(r({},e),{name:n})))}var P={subscribe:v};export{b as a,m as b,f as c,P as d,O as e,h as f,j as g,C as l,w as p,g as s,y as u};
