var n=Object.defineProperty,a=Object.defineProperties,e=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,c=(a,e,t)=>e in a?n(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,i=(n,a)=>{for(var e in a||(a={}))o.call(a,e)&&c(n,e,a[e]);if(t)for(var e of t(a))s.call(a,e)&&c(n,e,a[e]);return n},r=(n,t)=>a(n,e(t));import{Q as l,C as p}from"./vendor-e24d3430.js";const u={chats:[],connection:"disconnected",ship:window.ship,name:`~${window.ship}/welcome`,radius:10,gcp:null,s3:{configuration:{buckets:new Set,currentBucket:""},credentials:null},leaving:!1},{subscribe:v,update:f}=p(u);function d(n){console.log("[createCanvasStore]",n);const[a,e]=function(n){const a=[],e=[];return Object.entries(n).map((([n,t])=>{t.metadata.private?a.push(n):e.push(n)})),[a,e]}(n);f((t=>r(i({},t),{canvas:n,privateCanvas:a,publicCanvas:e})))}function b(n){(function(n){return"string"==typeof n.accessKey&&"number"==typeof n.expiresIn})(n)&&(console.log("[loadGCPToken]"),f((a=>r(i({},a),{gcp:{gcpToken:n}}))))}function g(n){console.log("[loadS3Creds]"),f((a=>r(i({},a),{s3:r(i({},a.s3),{credentials:n,client:new l({credentials:n,endpoint:n.endpoint,region:"us-east-1"})})})))}function m(n){console.log("[loadS3Config]"),f((a=>r(i({},a),{s3:r(i({},a.s3),{configuration:n})})))}function C(n){const a=`${n.location}/${n.name}`;console.log("[loadCanvas]",n,n.name),f((e=>r(i({},e),{canvas:i({[a]:{metadata:i({},n),data:n.data}},e.canvas),publicCanvas:n.private?e.publicCanvas:[a,...e.publicCanvas],privateCanvas:n.private?[a,...e.privateCanvas]:e.privateCanvas,name:a,leaving:!1})))}function w(n){console.log("[painting]",n),f((a=>{const e=`${n.location}/${n.name}`;return n.strokes.forEach((n=>{a.canvas[e].data[n.id]=i({},n)})),a}))}function y(n){f((a=>r(i({},a),{connection:n})))}function O(n){f((a=>r(i({},a),{api:n})))}function h(n){f((a=>r(i({},a),{subscription:n})))}function j(n){f((a=>r(i({},a),{name:n})))}function $(n,a){f((e=>{const t=`${n}/${a}`;return delete e.canvas[t],r(i({},e),{leaving:!0,publicCanvas:e.publicCanvas.filter((n=>n!==t))})}))}var P={subscribe:v};export{g as a,m as b,d as c,P as d,O as e,h as f,$ as g,j as h,C as l,w as p,b as s,y as u};
